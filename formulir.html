<!doctype html>

<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Formulir Sensus Penduduk</title>
  <style>
    :root{--bg:#f6f8fb;--card:#fff;--accent:#0b6efd;--muted:#666}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;margin:0;background:var(--bg);color:#111}
    .container{max-width:980px;margin:28px auto;padding:20px}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(10,20,40,0.06);margin-bottom:18px}
    h1,h2{margin:0 0 12px}
    label{display:block;font-size:13px;margin-bottom:6px;color:var(--muted)}
    input[type=text], input[type=date], select, textarea{width:100%;padding:10px 12px;border:1px solid #d7dbe6;border-radius:8px;font-size:14px}
    .grid{display:grid;gap:10px}
    .grid.cols-2{grid-template-columns:1fr 1fr}
    .row{display:flex;gap:10px}
    .small{font-size:13px;color:var(--muted)}
    .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
    button{background:var(--accent);color:white;padding:10px 14px;border:none;border-radius:8px;cursor:pointer}
    button.ghost{background:transparent;color:var(--accent);border:1px solid #d7dbe6}
    .member{border:1px dashed #e3e7ef;border-radius:10px;padding:12px;margin-bottom:10px}
    .member-header{display:flex;justify-content:space-between;align-items:center}
    .muted{color:var(--muted)}
    .inline{display:flex;gap:8px;align-items:center}
    @media (max-width:720px){.grid.cols-2{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="container">
    <h1>Formulir Sensus Penduduk</h1>
    <p class="small">FORMULIR SENSUS PENDUDUK (sumber: Scribd)</p>
    <form id="sensusForm" class="card">
      <h2>Alamat Keluarga Saat Ini</h2>
      <div class="grid cols-2">
        <div>
          <label>Provinsi</label>
          <input type="text" name="provinsi" placeholder="Contoh: Jawa Tengah" />
    </div>
    <div>
      <label>Kabupaten/Kota</label>
      <input type="text" name="kabupaten" placeholder="Contoh: Purbalingga" />
    </div>
    <div>
      <label>Kecamatan</label>
      <input type="text" name="kecamatan" />
    </div>
    <div>
      <label>Desa / Kelurahan</label>
      <input type="text" name="desa" />
    </div>
    <div>
      <label>RT / RW</label>
      <input type="text" name="rtrw" placeholder="RT/RW" />
    </div>
    <div>
      <label>Jalan</label>
      <input type="text" name="jalan" />
    </div>
  </div>

  <h3 style="margin-top:14px">Keterangan Tempat Tinggal</h3>
  <div class="grid cols-2">
    <div>
      <label>Status Kepemilikan</label>
      <select name="status_kepemilikan">
        <option value="">-- Pilih --</option>
        <option>Milik Sendiri</option>
        <option>Sewa</option>
        <option>Menumpang</option>
        <option>Dinas</option>
        <option>Lainnya</option>
      </select>
    </div>
    <div>
      <label>Listrik</label>
      <select name="listrik">
        <option value="">-- Pilih --</option>
        <option>1300</option>
        <option>450-900</option>
        <option>PLN - Tanpa Meteran</option>
        <option>Non PLN</option>
        <option>Lampu</option>
      </select>
    </div>
    <div>
      <label>Air Minum</label>
      <select name="air_minum">
        <option value="">-- Pilih --</option>
        <option>Isi Ulang</option>
        <option>PAM (PDAM)</option>
        <option>Pompa (Sumur)</option>
        <option>Sumur Timba</option>
        <option>Mata Air / Sungai</option>
        <option>Air Hujan</option>
        <option>Lainnya</option>
      </select>
    </div>
    <div>
      <label>Jamban</label>
      <select name="jamban">
        <option value="">-- Pilih --</option>
        <option>Septic Tank</option>
        <option>Non Septic Tank</option>
        <option>Tidak</option>
      </select>
    </div>
    <div>
      <label>Lantai Terluas</label>
      <select name="lantai">
        <option value="">-- Pilih --</option>
        <option>Keramik / Ubin</option>
        <option>Kayu</option>
        <option>Bambu</option>
        <option>Tanah</option>
        <option>Lainnya</option>
      </select>
    </div>
  </div>

  <hr style="margin:14px 0" />

  <div id="membersContainer">
    <!-- Member blocks will be injected here -->
  </div>

  <div class="actions">
    <button type="button" id="addMemberBtn" class="ghost">+ Tambah Anggota Keluarga</button>
    <button type="submit">Simpan / Unduh JSON</button>
  </div>
</form>

<div id="result" class="card" style="display:none">
  <h2>Hasil (JSON)</h2>
  <pre id="jsonOut" style="white-space:pre-wrap;word-break:break-word"></pre>
  <div class="actions"><button id="downloadBtn">Unduh JSON</button></div>
</div>

  </div>  <script>
    // Template for an anggota keluarga (member)
    const memberTemplate = (index)=>`
      <div class="member" data-member-index="${index}">
        <div class="member-header">
          <strong>Anggota Keluarga #${index+1}</strong>
          <div class="inline">
            <button type="button" class="ghost btn-remove">Hapus</button>
          </div>
        </div>

        <div class="grid cols-2" style="margin-top:8px">
          <div>
            <label>Nama</label>
            <input type="text" name="nama_${index}" />
          </div>
          <div>
            <label>Keberadaan</label>
            <select name="keberadaan_${index}">
              <option value="">-- Pilih --</option>
              <option>Ada</option>
              <option>Meninggal</option>
            </select>
          </div>
          <div>
            <label>Jenis Kelamin</label>
            <select name="jk_${index}">
              <option value="">-- Pilih --</option>
              <option>Laki-laki</option>
              <option>Perempuan</option>
            </select>
          </div>
          <div>
            <label>Tanggal Lahir</label>
            <input type="date" name="tgl_${index}" />
          </div>
          <div>
            <label>Status Hubungan dalam Keluarga</label>
            <select name="hubungan_${index}">
              <option value="">-- Pilih --</option>
              <option>Kepala Keluarga</option>
              <option>Suami</option>
              <option>Istri</option>
              <option>Anak</option>
              <option>Menantu</option>
              <option>Cucu</option>
              <option>Orang Tua</option>
              <option>Famili Lain</option>
            </select>
          </div>
          <div>
            <label>Alamat Sama?</label>
            <select name="alamat_sama_${index}">
              <option value="">-- Pilih --</option>
              <option>Ya</option>
              <option>Tidak</option>
            </select>
          </div>
          <div>
            <label>Sejak Kapan Tinggal</label>
            <input type="text" name="sejak_${index}" placeholder="Tahun/Bulan atau keterangan" />
          </div>
          <div>
            <label>Apakah Memiliki Akte?</label>
            <select name="akte_${index}">
              <option value="">-- Pilih --</option>
              <option>Ya</option>
              <option>Tidak</option>
            </select>
          </div>
          <div>
            <label>Suku</label>
            <input type="text" name="suku_${index}" />
          </div>
          <div>
            <label>Agama</label>
            <input type="text" name="agama_${index}" />
          </div>
          <div>
            <label>Status Perkawinan</label>
            <select name="status_perkawinan_${index}">
              <option value="">-- Pilih --</option>
              <option>Belum</option>
              <option>Sudah</option>
              <option>Cerai Hidup</option>
              <option>Cerai Mati</option>
            </select>
          </div>
          <div>
            <label>Akte Surat Nikah (jika ada)</label>
            <input type="text" name="akte_nikah_${index}" />
          </div>
          <div>
            <label>Pendidikan</label>
            <input type="text" name="pendidikan_${index}" placeholder="SD/SMP/SMA/Diploma/S1/..." />
          </div>
        </div>

        <h4 style="margin-top:10px">Aktivitas yang Biasa Dilakukan</h4>
        <div class="grid cols-2">
          <div>
            <label>Bekerja</label>
            <select name="aktiv_bekerja_${index}">
              <option value="">-- Pilih --</option>
              <option>Ya</option>
              <option>Tidak</option>
            </select>
          </div>
          <div>
            <label>Mengurus Rumah Tangga</label>
            <select name="aktiv_rumah_${index}">
              <option value="">-- Pilih --</option>
              <option>Ya</option>
              <option>Tidak</option>
            </select>
          </div>
          <div>
            <label>Sekolah / Kuliah</label>
            <select name="aktiv_sekolah_${index}">
              <option value="">-- Pilih --</option>
              <option>Ya</option>
              <option>Tidak</option>
            </select>
          </div>
          <div>
            <label>Pensiunan</label>
            <select name="aktiv_pensiun_${index}">
              <option value="">-- Pilih --</option>
              <option>Ya</option>
              <option>Tidak</option>
            </select>
          </div>
          <div style="grid-column:1 / -1">
            <label>Pekerjaan Utama</label>
            <input type="text" name="pekerjaan_${index}" placeholder="Deskripsi pekerjaan utama" />
          </div>
          <div>
            <label>Status Pekerjaan</label>
            <select name="status_pekerjaan_${index}">
              <option value="">-- Pilih --</option>
              <option>Berusaha Sendiri</option>
              <option>Berusaha Dibantu Pekerja</option>
              <option>Buruh</option>
              <option>Karyawan</option>
              <option>Pekerja Keluarga</option>
              <option>Lainnya</option>
            </select>
          </div>
        </div>
      </div>
    `;

    const membersContainer = document.getElementById('membersContainer');
    let memberCount = 0;

    function addMember(prefill={}){
      const idx = memberCount++;
      const wrapper = document.createElement('div');
      wrapper.innerHTML = memberTemplate(idx);
      membersContainer.appendChild(wrapper.firstElementChild);
      // attach remove handler
      const block = membersContainer.querySelector(`[data-member-index='${idx}']`);
      block.querySelector('.btn-remove').addEventListener('click', ()=>{
        block.remove();
      });

      // if prefill provided, fill fields
      if(Object.keys(prefill).length){
        for(const key in prefill){
          const el = block.querySelector([name='${key}_${idx}']) || block.querySelector([name='${key}']);
          if(el) el.value = prefill[key];
        }
      }
    }

    // add 1 default member
    addMember();

    document.getElementById('addMemberBtn').addEventListener('click', ()=>addMember());

    // Handle submit: collect form and show JSON
    document.getElementById('sensusForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const form = e.target;
      const data = {};

      // collect address and rumah data
      const fm = new FormData(form);
      data.alamat = {
        provinsi: fm.get('provinsi') || '',
        kabupaten: fm.get('kabupaten') || '',
        kecamatan: fm.get('kecamatan') || '',
        desa: fm.get('desa') || '',
        rtrw: fm.get('rtrw') || '',
        jalan: fm.get('jalan') || '',
        status_kepemilikan: fm.get('status_kepemilikan') || '',
        listrik: fm.get('listrik') || '',
        air_minum: fm.get('air_minum') || '',
        jamban: fm.get('jamban') || '',
        lantai: fm.get('lantai') || ''
      };

      // collect anggota keluarga
      data.anggota = [];
      const blocks = membersContainer.querySelectorAll('[data-member-index]');
      blocks.forEach(block=>{
        const idx = block.getAttribute('data-member-index');
        const get = (name)=>{
          const el = block.querySelector([name='${name}_${idx}']) || block.querySelector([name='${name}']);
          return el ? el.value : '';
        };
        const person = {
          nama: get('nama'),
          keberadaan: get('keberadaan'),
          jenis_kelamin: get('jk'),
          tanggal_lahir: get('tgl'),
          hubungan_keluarga: get('hubungan'),
          alamat_sama: get('alamat_sama'),
          sejak_tinggal: get('sejak'),
          memiliki_akte: get('akte'),
          suku: get('suku'),
          agama: get('agama'),
          status_perkawinan: get('status_perkawinan'),
          akte_nikah: get('akte_nikah'),
          pendidikan: get('pendidikan'),
          aktivitas_bekerja: get('aktiv_bekerja'),
          aktivitas_rumah: get('aktiv_rumah'),
          aktivitas_sekolah: get('aktiv_sekolah'),
          aktivitas_pensiun: get('aktiv_pensiun'),
          pekerjaan_utama: get('pekerjaan'),
          status_pekerjaan: get('status_pekerjaan')
        };
        // skip empty name entries
        if(person.nama || person.tanggal_lahir || person.pekerjaan_utama) data.anggota.push(person);
      });

      // show result
      const pretty = JSON.stringify(data, null, 2);
      document.getElementById('jsonOut').textContent = pretty;
      document.getElementById('result').style.display = 'block';

      // prepare download link data
      document.getElementById('downloadBtn').onclick = ()=>{
        const blob = new Blob([pretty], {type:'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'formulir_sensus.json';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      };

      // scroll to result
      document.getElementById('result').scrollIntoView({behavior:'smooth'});
    });

  </script></body>
</html>